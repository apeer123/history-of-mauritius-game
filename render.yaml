services:
  # Web Service (Next.js App)
  - type: web
    name: mauritius-game-app
    env: node
    plan: standard
    branch: main
    buildCommand: npm run build
    startCommand: sh scripts/start.sh
    healthCheckPath: /
    
    # Environment variables
    envVars:
      - key: NODE_ENV
        value: production
      
      # NextAuth Configuration
      - key: NEXTAUTH_URL
        fromService:
          type: web
          property: url
      - key: NEXTAUTH_SECRET
        sync: false
        # ⚠️ REQUIRED: Generate with: openssl rand -base64 32
        # Set in Render dashboard or before deploying
      
      # Database Configuration (PostgreSQL)
      - key: DATABASE_URL
        fromService:
          type: pserv
          name: mauritius-game-db
          property: connectionString
      
      # OAuth Providers (Update with your credentials)
      - key: GOOGLE_CLIENT_ID
        sync: false
      - key: GOOGLE_CLIENT_SECRET
        sync: false
      - key: FACEBOOK_APP_ID
        sync: false
      - key: FACEBOOK_APP_SECRET
        sync: false
      - key: RENDER_DISK_PATH
        value: /var/data
    
    # Connect to PostgreSQL
    databases:
      - name: mauritius-game-db

    # Persistent disk for image storage
    disk:
      name: question-images
      mountPath: /var/data
      sizeGB: 1

  # PostgreSQL Database
  - type: pserv
    name: mauritius-game-db
    ipAllowList: []
    plan: standard
    postgresVersion: 18
